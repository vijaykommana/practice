pipeline{
    agent 'any'
    stages{
        stage ('vcs'){
            steps{
                git url : 'https://github.com/vijaykommana/practice.git',
                branch : 'main'
            }
        }
        stage('build'){
            steps{
                 sh 'docker image build -t spc:1.2 .'
            }
        }
        stage('log and push'){
            steps{
                sh 'aws ecr get-login-password --region us-west-2 | docker login --username AWS --password-stdin 869388788941.dkr.ecr.us-west-2.amazonaws.com',
                sh "docker build tag spc:1.2 869388788941.dkr.ecr.us-west-2.amazonaws.com/vijay:3.0"
            }
        }
    }
}